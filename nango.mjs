var ee=Object.create;var G=Object.defineProperty;var te=Object.getOwnPropertyDescriptor;var re=Object.getOwnPropertyNames;var ne=Object.getPrototypeOf,oe=Object.prototype.hasOwnProperty;var ie=e=>`https://api.nango.dev/api/v1/${e}`;var se=e=>fetch(ie(e),{headers:{"Content-Type":"application/json"}}).then(t=>t.json()),B=class{constructor(t){this.config=t}async auth(t,r){let{data:o,error:i}=await se(`session-token?userId=${t}`);if(i)throw new Error(i.message);return this.connect(r,o.token)}connect(t,r){return new Promise((o,i)=>{let a=new URL("https://api.nango.dev/oauth/connect");a.searchParams.set("provider",t),a.searchParams.set("sessionToken",r);let s=window.open(a.toString(),"nango-auth","width=600,height=800"),l=setInterval(()=>{try{s.closed?i(new Error("Authorization window was closed.")):s.location.href.includes("nango.dev/oauth/callback")&&(s.close(),clearInterval(l),this.#postAuth(t,r).then(o).catch(i))}catch(c){}},500)});o(e);var c,u,d}async #postAuth(t,r){let{data:o,error:i}=await se(`connection?provider=${t}&sessionToken=${r}`);if(i)throw new Error(i.message);return o}};export{B as default};
